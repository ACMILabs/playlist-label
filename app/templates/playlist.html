<!doctype html>
<html>
  <head>
      <title>Playlist: {{ playlist_json.title }}</title>
      <link rel="stylesheet" href="{{ url_for('static', filename='playlist.css') }}">
  </head>

  <body class="container playlist-label-body">
      <main>
          <article class="playlist-label">
              <div class="playlist-label-container" id="playlist-label-js-hook">
                  {% for item in playlist_json.playlist_labels %}
                      {% if loop.index == 1 %}
                          <div class="row">
                              <div class="col-sm">
                                  <h1>{{ item.label.title }}</h1>
                                  <h2>{{ item.label.subtitles }}</h2>
                              </div>
                              <div class="col-sm label-description">
                                  <div id='content0' class="content {{ 'content_smaller' if item.label.columns[0].style == 'smaller' else 'standard' }}">
                                    {{ item.label.columns[0].content|safe }}
                                  </div>
                                  <div id='content1' class="content {{ 'content_smaller' if item.label.columns[1].style == 'smaller' else 'standard' }}">
                                    {{ item.label.columns[1].content|safe }}
                                  </div>
                                  <div id='content2' class="content {{ 'content_smaller' if item.label.columns[2].style == 'smaller' else 'standard' }}">
                                    {{ item.label.columns[2].content|safe }}
                                  </div>
                              </div>
                              <div class="col-sm image-container">
                                  {% if item.label.works|length > 0 %}
                                      <img src="{{ item.label.works.0.public_images.0.image_file }}" alt="{{ item.label.title }}" title="{{ item.label.title }}">
                                  {% endif %}
                              </div>
                          </div>
                      {% endif %}
                      {% if loop.index == 2 %}
                          <h3>Next</h3>
                          <h4>{{ item.label.title }}</h4>
                          <h5>{{ item.label.subtitles }}</h5>
                      {% endif %}
                  {% endfor %}
                  {% if not playlist_json %}
                  <div class="row">
                      <div class="col-sm">
                          <h1>Playlist not found ðŸ˜­</h1>
                          <h2>Sorry, there isn't a playist for that id.</h2>
                      </div>
                  </div>
                  {% endif %}
              </div>
              <div class="progress-bar-container">
                  <div class="progress-bar"></div>
              </div>
          </article>
      </main>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js" type="text/javascript"></script>
      <script src="{{ url_for('static', filename='playlist.js') }}" type="module"></script>
  </body>

  <script>
      window.playlistLabelData = {
          "id": "{{ playlist_json.id }}",
          "current_label_id": "{% if playlist_json.playlist_labels|length > 0 %}{{ playlist_json.playlist_labels.0.label.id }}{% endif %}",
          "next_label_id": "{% if playlist_json.playlist_labels|length > 1 %}{{ playlist_json.playlist_labels.1.label.id }}{% elif playlist_json.playlist_labels|length > 0 %}{{ playlist_json.playlist_labels.0.label.id }}{% endif %}",
          "mqtt_host": "{{ mqtt.host }}",
          "mqtt_port": "{{ mqtt.port }}",
          "mqtt_username": "{{ mqtt.username }}",
          "mqtt_password": "{{ mqtt.password }}",
          "xos_playlist_endpoint": "{{ xos.playlist_endpoint }}",
          "xos_media_player_id": "{{ xos.media_player_id }}"
      }
  </script>
</html>
